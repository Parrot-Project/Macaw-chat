中文 | [English](README.en.md)
# Macaw
**Macaw** 是一个开源的加密聊天软件，使用 Rust 构建。它专注于提供一个跨平台、安全、私密的消息传递体验。不管你是在桌面端还是移动端，Macaw 都能确保你的消息安全。

**目前正在开发中。**

## 功能
- 端到端加密，保护私密信息
- 跨平台支持（Windows、macOS、Linux 和移动端）
- 开源，注重安全和性能

### **Macaw 服务器端原理概述**

**目标**：构建一个简单的服务器端，用于存储加密消息，并确保消息在一定时间后被回收。服务器不解密消息，也不主动发送消息，仅提供消息存储、查询和回收功能。

#### **基本工作流程**：
1. **接收消息**：
    - 客户端发送的消息格式为：`[存储时间][对方代号][加密消息]`。
    - 服务器接收到消息后，记录消息的存储时间，并将其存储在消息池中。

2. **消息存储**：
    - 服务器将接收到的消息存储在内存中的数据结构（如 `HashMap`）中，消息的存储时间和过期时间（当前时间加上存储时长）一起被记录。

3. **回收机制**：
    - 为防止消息堆积过多，服务器定期检查所有存储的消息，删除已过期的消息。
    - 回收机制周期性执行，例如每小时运行一次，检查每条消息的过期时间，并清理过期消息。

4. **消息查询**：
    - 客户端通过提供自己的代号，查询与自己相关的消息。服务器仅返回匹配的消息（加密后的内容），并不解密消息内容。

#### **简要步骤**：
1. **存储**：服务器将消息存入内存，包含消息的存储时间、接收方代号和加密的消息内容。
2. **回收**：定期清理过期消息，防止消息池过大。
3. **查询**：客户端可以通过代号查询相关加密消息，服务器仅返回加密的内容，解密由客户端完成。

#### **消息格式**：
- 每条消息包含：
    - **存储时间**：消息的存储时间，决定消息的生命周期。
    - **对方代号**：消息的接收方标识，用于查询和筛选。
    - **加密消息**：消息内容，经过加密以保证隐私。

#### **回收机制**：
- 服务器定期检查消息池，删除过期的消息，确保消息池不会无限增大。

#### **核心技术栈**：
- 使用 `tokio` 异步框架处理并发请求。
- 存储使用内存中的 `HashMap`，可以根据需要扩展为文件或数据库存储。
- 回收机制通过定时任务周期性触发，清理过期消息。

### **总结**
- **服务器职责**：存储加密消息，提供消息查询与回收，确保消息的隐私性和有效性。
- **客户端职责**：加密和解密消息，通过代号查询相关消息。

### **Macaw 客户端概述**

**目标**：构建一个客户端，能够加密和解密消息，将加密后的消息发送到服务器，并通过唯一的接收方代号从服务器查询消息。客户端通过加密和解密过程保证消息的隐私性，而服务器仅负责存储和返回加密数据。

#### **基本工作流程**：
1. **加密消息**：
    - 客户端在发送消息之前对消息内容进行加密。
    - 消息会与接收方的代号和过期时间一起打包。
    - 加密后的消息被发送到服务器存储。

2. **解密消息**：
    - 客户端通过自己的代号查询与自己相关的消息。
    - 服务器返回加密的消息。
    - 客户端解密消息并将其显示给用户。

3. **消息发送**：
    - 客户端将加密的消息发送到服务器，服务器将其存储，并供接收方检索。

4. **隐私性**：
    - 消息使用安全的加密算法（例如 AES）进行加密。
    - 服务器无法读取或修改消息内容，因为服务器只存储加密数据。

#### **消息格式**：
- 从客户端发送的消息是加密的，包含：
    - **接收方代号**：接收方的标识符，服务器用它来存储和检索消息。
    - **加密消息**：实际的消息内容，经过加密以确保隐私。
    - **过期时间**：消息的过期时间，过期后服务器会删除该消息。

### **总结**
- **客户端职责**：加密和解密消息，将消息发送到服务器，并通过接收方代号查询相关的加密消息。
- **服务器职责**：存储加密消息，并允许客户端查询和检索这些消息，但无法解密消息。
